<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>积分详情 - 任务中心</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        dark: '#1E293B',
                        light: '#F8FAFC',
                        accent: '#8B5CF6'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .card-hover {
                transition: all 0.3s ease;
            }
            .card-hover:hover {
                transform: translateY(-5px);
            }
            .pulse-animation {
                animation: pulse 2s infinite;
            }
            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.05); }
                100% { transform: scale(1); }
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-800">
<!-- 导航栏 -->
<nav class="fixed w-full bg-white/90 backdrop-blur-sm shadow-sm z-50 transition-all duration-300" id="navbar">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
        <div class="flex items-center space-x-2">
            <a href="../../../index.html" class="text-primary flex items-center" onclick="saveLastVisitedPage()">
                <i class="fa fa-tasks text-2xl mr-2"></i>
                <span class="font-bold text-xl text-dark">任务中心</span>
            </a>
        </div>
        <div class="hidden md:flex space-x-8">
            <a href="../mx_task.html#tasks" class="text-gray-600 hover:text-primary transition-colors">任务列表</a>
            <a href="../mx_task.html#repository" class="text-gray-600 hover:text-primary transition-colors">网址库</a>
            <a href="../mx_task.html#points" class="text-gray-600 hover:text-primary transition-colors">我的积分</a>
        </div>
        <button class="md:hidden text-gray-600" id="menuToggle">
            <i class="fa fa-bars text-xl"></i>
        </button>
    </div>
    <!-- 移动端菜单 -->
    <div class="md:hidden hidden bg-white border-t" id="mobileMenu">
        <div class="container mx-auto px-4 py-3 flex flex-col space-y-4">
            <a href="../mx_task.html#tasks" class="text-gray-600 hover:text-primary transition-colors py-2">任务列表</a>
            <a href="../mx_task.html#repository" class="text-gray-600 hover:text-primary transition-colors py-2">网址库</a>
            <a href="../mx_task.html#points" class="text-gray-600 hover:text-primary transition-colors py-2">我的积分</a>
        </div>
    </div>
</nav>

<!-- 英雄区域 -->
<header class="pt-24 pb-16 md:pt-32 md:pb-24 bg-gradient-to-br from-blue-50 to-purple-50">
    <div class="container mx-auto px-4">
        <div class="text-center mb-10">
            <h1 class="text-[clamp(2rem,5vw,3.5rem)] font-bold leading-tight text-dark mb-4">
                积分<span class="bg-gradient-to-r from-primary to-accent text-gradient">详情</span>
            </h1>
            <p class="text-lg text-gray-600 max-w-2xl mx-auto">
                查看您的积分详情、获取记录以及积分规则说明
            </p>
        </div>

        <div class="max-w-4xl mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                <div class="bg-gradient-to-br from-primary/10 to-blue-100 rounded-xl p-6 shadow-sm">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-primary/20 rounded-full flex items-center justify-center mr-4">
                            <i class="fa fa-star text-primary text-xl"></i>
                        </div>
                        <div>
                            <p class="text-gray-500 text-sm">当前积分</p>
                            <p class="text-2xl font-bold text-dark" id="currentPoints">0</p>
                        </div>
                    </div>
                </div>

                <div class="bg-gradient-to-br from-secondary/10 to-green-100 rounded-xl p-6 shadow-sm">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-secondary/20 rounded-full flex items-center justify-center mr-4">
                            <i class="fa fa-trophy text-secondary text-xl"></i>
                        </div>
                        <div>
                            <p class="text-gray-500 text-sm">已完成任务</p>
                            <p class="text-2xl font-bold text-dark" id="completedTasks">0</p>
                        </div>
                    </div>
                </div>

                <div class="bg-gradient-to-br from-accent/10 to-purple-100 rounded-xl p-6 shadow-sm">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-accent/20 rounded-full flex items-center justify-center mr-4">
                            <i class="fa fa-gift text-accent text-xl"></i>
                        </div>
                        <div>
                            <p class="text-gray-500 text-sm">可兑换奖励</p>
                            <p class="text-2xl font-bold text-dark" id="redeemableRewards">0</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- 积分统计 -->
<section class="py-16 bg-white">
    <div class="container mx-auto px-4">
        <div class="text-center mb-16">
            <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold text-dark mb-4">积分统计</h2>
            <p class="text-gray-600 max-w-2xl mx-auto">查看您的积分获取趋势和分布情况</p>
        </div>

        <div class="max-w-6xl mx-auto">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
                <div class="bg-gray-50 rounded-xl p-6">
                    <h3 class="text-xl font-semibold mb-4">月度积分趋势</h3>
                    <div class="h-64 flex items-center justify-center">
                        <p class="text-gray-500">图表功能待开发</p>
                    </div>
                </div>

                <div class="bg-gray-50 rounded-xl p-6">
                    <h3 class="text-xl font-semibold mb-4">积分来源分布</h3>
                    <div class="h-64 flex items-center justify-center">
                        <p class="text-gray-500">图表功能待开发</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- 积分获取记录 -->
<section class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
        <div class="text-center mb-16">
            <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold text-dark mb-4">积分获取记录</h2>
            <p class="text-gray-600 max-w-2xl mx-auto">查看您所有的积分获取历史</p>
        </div>

        <div class="max-w-6xl mx-auto">
            <div class="bg-white rounded-xl p-6 shadow-sm">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-semibold">详细记录</h3>
                    <div class="flex space-x-2">
                        <select id="yearFilter" class="border rounded px-3 py-2 text-sm">
                            <option>2025年</option>
                            <option>2024年</option>
                        </select>
                        <select id="monthFilter" class="border rounded px-3 py-2 text-sm">
                            <option>全部月份</option>
                            <option>1月</option>
                            <option>2月</option>
                            <option>3月</option>
                            <option>4月</option>
                            <option>5月</option>
                            <option>6月</option>
                            <option>7月</option>
                            <option>8月</option>
                            <option>9月</option>
                            <option>10月</option>
                            <option>11月</option>
                            <option>12月</option>
                        </select>
                    </div>
                </div>
                
                <div id="pointsHistory" class="space-y-3">
                    <p class="text-gray-500 text-center py-8">暂无积分获取记录</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- 积分规则 -->
<section class="py-16 bg-white">
    <div class="container mx-auto px-4">
        <div class="text-center mb-16">
            <h2 class="text-[clamp(1.8rem,4vw,2.5rem)] font-bold text-dark mb-4">积分规则</h2>
            <p class="text-gray-600 max-w-2xl mx-auto">了解积分的获取、使用和管理规则</p>
        </div>

        <div class="max-w-4xl mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100">
                    <div class="flex items-center mb-4">
                        <div class="w-10 h-10 bg-primary/20 rounded-full flex items-center justify-center mr-3">
                            <i class="fa fa-clock-o text-primary"></i>
                        </div>
                        <h3 class="text-xl font-semibold">每日自动提交</h3>
                    </div>
                    <p class="text-gray-600 mb-4">
                        系统每天自动提交您的积分流水记录，确保数据准确性。提交时会进行必要的校验，防止异常数据。
                    </p>
                    <div class="text-sm text-gray-500">
                        <p class="flex items-center mb-1">
                            <i class="fa fa-check-circle text-secondary mr-2"></i>
                            自动记录每日积分变化
                        </p>
                        <p class="flex items-center mb-1">
                            <i class="fa fa-check-circle text-secondary mr-2"></i>
                            数据校验确保准确性
                        </p>
                        <p class="flex items-center">
                            <i class="fa fa-check-circle text-secondary mr-2"></i>
                            异常情况自动报警
                        </p>
                    </div>
                </div>

                <div class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 border border-green-100">
                    <div class="flex items-center mb-4">
                        <div class="w-10 h-10 bg-secondary/20 rounded-full flex items-center justify-center mr-3">
                            <i class="fa fa-calendar text-secondary"></i>
                        </div>
                        <h3 class="text-xl font-semibold">每月自动汇总</h3>
                    </div>
                    <p class="text-gray-600 mb-4">
                        每月初系统自动汇总上个月的积分数据，生成月度报告，便于您了解积分获取情况。
                    </p>
                    <div class="text-sm text-gray-500">
                        <p class="flex items-center mb-1">
                            <i class="fa fa-check-circle text-secondary mr-2"></i>
                            自动生成月度积分报表
                        </p>
                        <p class="flex items-center mb-1">
                            <i class="fa fa-check-circle text-secondary mr-2"></i>
                            统计各类任务积分贡献
                        </p>
                        <p class="flex items-center">
                            <i class="fa fa-check-circle text-secondary mr-2"></i>
                            提供数据分析参考
                        </p>
                    </div>
                </div>

                <div class="bg-gradient-to-br from-purple-50 to-violet-50 rounded-xl p-6 border border-purple-100">
                    <div class="flex items-center mb-4">
                        <div class="w-10 h-10 bg-accent/20 rounded-full flex items-center justify-center mr-3">
                            <i class="fa fa-money text-accent"></i>
                        </div>
                        <h3 class="text-xl font-semibold">年度手动变现</h3>
                    </div>
                    <p class="text-gray-600 mb-4">
                        每年您可以手动申请将积分变现，系统会在审核后处理您的变现请求。
                    </p>
                    <div class="text-sm text-gray-500">
                        <p class="flex items-center mb-1">
                            <i class="fa fa-check-circle text-secondary mr-2"></i>
                            每年一次变现机会
                        </p>
                        <p class="flex items-center mb-1">
                            <i class="fa fa-check-circle text-secondary mr-2"></i>
                            手动申请处理机制
                        </p>
                        <p class="flex items-center">
                            <i class="fa fa-check-circle text-secondary mr-2"></i>
                            专业团队审核保障
                        </p>
                    </div>
                </div>

                <div class="bg-gradient-to-br from-amber-50 to-yellow-50 rounded-xl p-6 border border-amber-100">
                    <div class="flex items-center mb-4">
                        <div class="w-10 h-10 bg-amber-500/20 rounded-full flex items-center justify-center mr-3">
                            <i class="fa fa-gift text-amber-500"></i>
                        </div>
                        <h3 class="text-xl font-semibold">积分用途</h3>
                    </div>
                    <p class="text-gray-600 mb-4">
                        积分可用于兑换各种奖励和特权，更多功能正在开发中，敬请期待。
                    </p>
                    <div class="text-sm text-gray-500">
                        <p class="flex items-center mb-1">
                            <i class="fa fa-check-circle text-secondary mr-2"></i>
                            兑换精美礼品
                        </p>
                        <p class="flex items-center mb-1">
                            <i class="fa fa-check-circle text-secondary mr-2"></i>
                            获取专属特权
                        </p>
                        <p class="flex items-center">
                            <i class="fa fa-check-circle text-secondary mr-2"></i>
                            更多功能持续更新
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- 页脚 -->
<footer class="bg-dark text-white py-12">
    <div class="container mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
            <div>
                <div class="flex items-center space-x-2 mb-6">
                    <i class="fa fa-tasks text-primary text-2xl"></i>
                    <span class="font-bold text-xl">任务中心</span>
                </div>
                <p class="text-gray-400 mb-6">完成任务获取积分，积分本地存储，无需服务器交互。</p>
                <div class="flex space-x-4">
                    <a href="#" class="text-gray-400 hover:text-primary transition-colors">
                        <i class="fa fa-weixin text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-primary transition-colors">
                        <i class="fa fa-weibo text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-primary transition-colors">
                        <i class="fa fa-qq text-xl"></i>
                    </a>
                </div>
            </div>

            <div>
                <h4 class="font-semibold text-lg mb-6">快速链接</h4>
                <ul class="space-y-3">
                    <li><a href="../mx_task.html#tasks" class="text-gray-400 hover:text-white transition-colors">任务列表</a></li>
                    <li><a href="../mx_task.html#repository" class="text-gray-400 hover:text-white transition-colors">网址库</a></li>
                    <li><a href="../mx_task.html#points" class="text-gray-400 hover:text-white transition-colors">我的积分</a></li>
                </ul>
            </div>

            <div>
                <h4 class="font-semibold text-lg mb-6">联系我们</h4>
                <ul class="space-y-3">
                    <li class="flex items-center">
                        <i class="fa fa-envelope-o text-primary mr-3"></i>
                        <a href="mailto:support@example.com" class="text-gray-400 hover:text-white transition-colors">support@example.com</a>
                    </li>
                    <li class="flex items-center">
                        <i class="fa fa-phone text-primary mr-3"></i>
                        <a href="tel:4001234567" class="text-gray-400 hover:text-white transition-colors">400-123-4567</a>
                    </li>
                </ul>
            </div>

            <div>
                <h4 class="font-semibold text-lg mb-6">积分说明</h4>
                <ul class="space-y-3 text-gray-400">
                    <li>• 完成任务获得积分</li>
                    <li>• 积分本地存储</li>
                    <li>• 无需服务器交互</li>
                    <li>• 可兑换礼品</li>
                </ul>
            </div>
        </div>

        <div class="border-t border-gray-800 mt-12 pt-8 text-center text-gray-500 text-sm">
            <p>© 2025 任务中心 版权所有</p>
        </div>
    </div>
</footer>

<script>
    // 保存最后访问的页面信息
    function saveLastVisitedPage() {
        const currentPage = window.location.href;
        const currentPageName = "积分详情";
        localStorage.setItem('last_visited_page', currentPage);
        localStorage.setItem('last_visited_page_name', currentPageName);
    }

    // 移动端菜单切换
    document.getElementById('menuToggle').addEventListener('click', function() {
        const mobileMenu = document.getElementById('mobileMenu');
        mobileMenu.classList.toggle('hidden');
    });

    // 导航栏滚动效果
    window.addEventListener('scroll', function() {
        const navbar = document.getElementById('navbar');
        if (window.scrollY > 50) {
            navbar.classList.add('py-2', 'shadow');
            navbar.classList.remove('py-3');
        } else {
            navbar.classList.add('py-3');
            navbar.classList.remove('py-2', 'shadow');
        }
    });

    // 积分系统
    class PointSystem {
        constructor() {
            this.points = 0;
            this.completedTasks = 0;
            this.pointsHistory = [];
            this.loadFromLocalStorage();
        }

        // 从本地存储加载积分数据
        loadFromLocalStorage() {
            try {
                const savedPoints = localStorage.getItem('taskPoints');
                const savedTasks = localStorage.getItem('completedTasks');
                const savedHistory = localStorage.getItem('pointsHistory');
                
                if (savedPoints) this.points = parseInt(savedPoints);
                if (savedTasks) this.completedTasks = parseInt(savedTasks);
                if (savedHistory) this.pointsHistory = JSON.parse(savedHistory);
            } catch (e) {
                console.error('加载积分数据失败:', e);
            }
        }

        // 更新UI显示
        updateUI() {
            document.getElementById('currentPoints').textContent = this.points;
            document.getElementById('completedTasks').textContent = this.completedTasks;
            document.getElementById('redeemableRewards').textContent = Math.floor(this.points / 100);
            
            // 更新积分历史
            this.updatePointsHistory();
        }

        // 更新积分历史显示
        updatePointsHistory() {
            const historyContainer = document.getElementById('pointsHistory');
            if (this.pointsHistory.length === 0) {
                historyContainer.innerHTML = '<p class="text-gray-500 text-center py-8">暂无积分获取记录</p>';
                return;
            }
            
            let historyHTML = '';
            this.pointsHistory.forEach(record => {
                const date = new Date(record.timestamp);
                const formattedDate = `${date.getMonth()+1}-${date.getDate()} ${date.getHours()}:${String(date.getMinutes()).padStart(2, '0')}`;
                
                historyHTML += `
                <div class="flex items-center justify-between p-4 bg-white rounded-lg border">
                    <div>
                        <p class="font-medium">${record.taskName}</p>
                        <p class="text-sm text-gray-500">${formattedDate}</p>
                    </div>
                    <div class="text-right">
                        <p class="font-semibold text-secondary">+${record.points}</p>
                    </div>
                </div>
                `;
            });
            
            historyContainer.innerHTML = historyHTML;
        }
    }

    // 初始化系统
    let pointSystem;

    document.addEventListener('DOMContentLoaded', function() {
        // 初始化积分系统
        pointSystem = new PointSystem();
        pointSystem.updateUI();
        
        // 初始化ESC键监听
        if (typeof initGlobalEscapeKeyListener === 'function') {
            initGlobalEscapeKeyListener();
        }
    });
</script>

<script src="../../js/global_escape_listener.js"></script>
</body>
</html>